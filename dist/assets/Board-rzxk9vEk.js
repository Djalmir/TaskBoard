import{_ as le,r as t,J as Le,k as fe,o as u,a as K,w as M,t as re,i as w,B as U,b as ue,d as v,I as pe,q as we,e as me,c as x,s as q,m as De,z as ye,A as ae,l as be,v as Ce,x as ke,y as H,K as Se,L as ge,T as Ee,F as Q,M as j,N as Fe,H as T,u as $e,E as se,D as Be,p as Ve,h as ze,f as Me,C as xe,n as Je,O as _e,P as qe}from"./index-WAPgc1jt.js";import{t as G,U as Oe,P as Pe,a as je}from"./ProfileModal-5UOpWRvs.js";import{M as We}from"./date-xrtNf6vk.js";const Ye={__name:"ListModal",emits:["listCreated","listRenamed"],setup(a,{expose:g,emit:y}){const f=t(),D=Le(),S=fe("Message").value,_=D.params.boardId,k=t(""),I=t(""),h=t(!1),l=y;function b(V){if(V){const{_id:z,name:O}=JSON.parse(JSON.stringify(V));k.value=z,I.value=O,h.value=!0}else h.value=!1;f.value.show()}function B(){G.createList({boardId:_,name:I.value}).then(V=>{l("listCreated",V.data),s()})}function E(){G.updateList({listId:k.value,name:I.value}).then(V=>{l("listRenamed",V.data),s()})}function s(){k.value="",I.value="",f.value.close()}return g({show:b}),(V,z)=>(u(),K(We,{ref_key:"modal",ref:f,onClose:s,onKeypress:z[2]||(z[2]=me(()=>h.value?E():B(),["enter"]))},{header:M(()=>[w("b",null,re(h.value?"Renomear":"Nova")+" Lista",1)]),footer:M(()=>[v(U,{class:"secondary",onClick:s},{default:M(()=>[ue("Cancelar")]),_:1}),h.value?(u(),K(U,{key:0,type:"submit",onClick:E},{default:M(()=>[ue("Atualizar")]),_:1})):(u(),K(U,{key:1,type:"submit",onClick:B},{default:M(()=>[ue("Criar")]),_:1}))]),default:M(()=>[v(pe,{class:"input",label:"Nome",modelValue:I.value,"onUpdate:modelValue":z[0]||(z[0]=O=>I.value=O),autocomplete:"getoff",onFocus:z[1]||(z[1]=O=>we(S).closeByField("name"))},null,8,["modelValue"])]),_:1},512))}},Ge=le(Ye,[["__scopeId","data-v-0f93a94b"]]),Qe={key:0},Ze=["value"],et={__name:"Textarea",props:["modelValue","label"],setup(a){return(g,y)=>(u(),x("label",null,[a.label?(u(),x("span",Qe,re(a.label),1)):q("",!0),w("textarea",De({value:a.modelValue,onInput:y[0]||(y[0]=f=>g.$emit("update:modelValue",f.target.value))},g.$attrs),null,16,Ze)]))}},Ie=le(et,[["__scopeId","data-v-5f3c5f99"]]),tt={class:"carouselUi"},ot={class:"carouselUi"},nt={__name:"Carousel",props:{class:{type:String}},setup(a,{expose:g}){var X,oe;ye(p=>({"2d6388e2":V.value}));const y=a,f=t(),D=t(),S=t(),_=t(),k=t(),I=t(),h=t([]),l=t([]),b=t(0),B=t(),E=t(),s=t(!1),V=t(`${((X=f.value)==null?void 0:X.parentElement.offsetWidth)||0}px`),z=t(`${((oe=f.value)==null?void 0:oe.parentElement.offsetWidth)*.75||0}px`);ae(s,()=>{setTimeout(()=>{var p;W(b.value,"smooth"),(p=D.value)==null||p.focus()},250)}),be(()=>{O(),window.addEventListener("resize",A),A()});function O(){let p={childList:!0};B.value=new MutationObserver(()=>{A()}),B.value.observe(k.value,p),B.value.observe(I.value,p),p={root:document.documentElement},E.value=new IntersectionObserver(n=>{n.forEach(c=>{c.isIntersecting&&A()})}),E.value.observe(f.value,p)}function F(){if(h.value=k.value?Array.from(k.value.children):[],!h.value.length){s.value&&(s.value=!1);return}h.value.map(p=>{p.style=`
			width: ${z.value};
			height: calc(100% - 33px);
			aspect-ratio: 16/9;
		`}),setTimeout(()=>{W(b.value,"auto")},0),l.value=I.value?Array.from(I.value.children):[],l.value.map(p=>{p.style=`
			width: ${window.innerWidth}px;
			height: calc(100dvh - 33px);
			overflow: auto;
		`})}function W(p,n="smooth"){h.value.length&&(p<0?p=0:p>=h.value.length&&(p=h.value.length-1),setTimeout(()=>{if(f.value){b.value=p;let c=f.value.getBoundingClientRect(),N=k.value.getBoundingClientRect(),ee=Array.from(k.value.children)[p].getBoundingClientRect();S.value.scrollTo({top:0,left:ee.x-N.x-(c.width-ee.width)/2,behavior:n}),setTimeout(()=>{if(I.value){let ie=I.value.getBoundingClientRect(),ne=Array.from(I.value.children)[p].getBoundingClientRect();_.value.scrollTo({top:0,left:ne.x-ie.x-(window.innerWidth-ne.width)/2,behavior:n})}},0)}},0))}function Z(p){switch(p.key){case"ArrowLeft":W(--b.value);break;case"ArrowRight":W(++b.value);break}}function A(){var p,n;V.value=`${((p=f.value)==null?void 0:p.parentElement.offsetWidth)||0}px`,z.value=`${((n=f.value)==null?void 0:n.parentElement.offsetWidth)*.75||0}px`,F()}return g({fullScreen:s}),(p,n)=>(u(),x(Q,null,[w("div",{class:ge(`carousel ${y.class||""}`),ref_key:"carousel",ref:f},[Ce(w("div",tt,[v(H,{class:"chevron-left",size:2,onClick:n[0]||(n[0]=c=>W(--b.value))}),v(H,{class:"chevron-right",size:2,onClick:n[1]||(n[1]=c=>W(++b.value))})],512),[[ke,h.value.length]]),Ce(w("div",{class:"carouselScroll",ref_key:"scroller",ref:S},[w("div",{class:"carouselSlidesWrapper",ref_key:"carouselSlidesWrapper",ref:k,onClick:n[2]||(n[2]=c=>s.value=!s.value)},[Se(p.$slots,"default",{},void 0,!0)],512)],512),[[ke,h.value.length]])],2),v(Ee,{name:"grow"},{default:M(()=>[Ce(w("div",{class:ge(`fullScreenCarousel ${y.class||""}`),ref_key:"fullScreenCarousel",ref:D,tabindex:"0",onKeydown:[n[6]||(n[6]=me(c=>{s.value&&(s.value=!1),c.stopPropagation(),c.preventDefault()},["escape"])),Z]},[w("div",ot,[v(H,{class:"chevron-left",size:2,onClick:n[3]||(n[3]=c=>W(--b.value))}),v(H,{class:"chevron-right",size:2,onClick:n[4]||(n[4]=c=>W(++b.value))})]),w("div",{class:"fullScreenCarouselScroll",ref_key:"fullScreenscroller",ref:_},[w("div",{class:"fullScreenCarouselSlidesWrapper",ref_key:"fullScreenCarouselSlidesWrapper",ref:I,onClick:n[5]||(n[5]=c=>s.value=!s.value)},[Se(p.$slots,"default",{},void 0,!0)],512)],512)],34),[[ke,s.value]])]),_:3})],64))}},Ne=le(nt,[["__scopeId","data-v-2546a38e"]]),st=["checked"],at={__name:"Checkbox",props:{modelValue:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},class:{type:String},pin:{type:Boolean,default:!1}},setup(a){ye(f=>({"61d6bacc":y.value}));const g=a,y=j(()=>g.rounded||g.pin?"50%":"0.15em");return(f,D)=>(u(),x("input",De({type:"checkbox",checked:a.modelValue,onChange:D[0]||(D[0]=S=>f.$emit("update:modelValue",S.target.checked)),class:`${g.class?g.class:""} ${g.pin?"pin":""}`},f.$attrs),null,16,st))}},lt=le(at,[["__scopeId","data-v-64f9a7c4"]]),it={key:0,class:"todoActions"},dt={__name:"Todo",props:{todo:Object},emits:["removeTodo","newTodo","editTodo"],setup(a,{emit:g}){const y=a,f=t(),D=g;ae(()=>y.todo.done,()=>{D("editTodo",y.todo)});function S(){y.todo.editing=!0,setTimeout(()=>{f.value.$el.focus()},0)}function _(){var h;if(!((h=y.todo.todo)!=null&&h.trim()))return!1;y.todo.editing=!1,D("editTodo",y.todo)}function k(){D("removeTodo",y.todo)}function I(){_(),D("newTodo")}return(h,l)=>(u(),x("li",{class:"todo",onClick:l[2]||(l[2]=()=>{a.todo.editing||(a.todo.done=!a.todo.done)}),onMouseenter:l[3]||(l[3]=b=>a.todo.mouseIn=!0),onMouseleave:l[4]||(l[4]=b=>a.todo.mouseIn=!1)},[v(lt,{modelValue:a.todo.done,"onUpdate:modelValue":l[0]||(l[0]=b=>a.todo.done=b)},null,8,["modelValue"]),v(pe,{ref_key:"input",ref:f,disabled:!a.todo.editing,onBlur:_,onKeypress:me(I,["enter"]),class:"todoInput",modelValue:a.todo.todo,"onUpdate:modelValue":l[1]||(l[1]=b=>a.todo.todo=b),placeholder:"Descreva a tarefa",style:Fe(`${a.todo.editing?"":"box-shadow: none; background: transparent; cursor: pointer; pointer-events: none;"} width: 100%;`)},null,8,["disabled","onKeypress","modelValue","style"]),a.todo.mouseIn&&a.todo.canEdit?(u(),x("div",it,[a.todo.editing?q("",!0):(u(),K(U,{key:0,class:"flat actionButton",onClick:T(S,["stop"])},{default:M(()=>[v(H,{class:"edit",size:1.25})]),_:1},8,["onClick"])),v(U,{class:"flat actionButton",onClick:T(k,["stop"]),style:{color:"var(--danger-light)"}},{default:M(()=>[v(H,{class:"trash-2",size:1.25})]),_:1},8,["onClick"])])):q("",!0)],32))}},Re=le(dt,[["__scopeId","data-v-43300fdc"]]),Ue=a=>(Ve("data-v-1c5db466"),a=a(),ze(),a),rt={key:0},ut={class:"todosList"},ct=Ue(()=>w("span",null,"Adicionar Todo",-1)),vt={key:0},ft=["onMouseenter","onMouseleave"],mt=["src"],pt=Ue(()=>w("span",null,"Adicionar Imagens",-1)),gt={id:"assignedList"},ht={__name:"CardModal",props:{members:{type:Array}},emits:["cardCreated","cardEdited"],setup(a,{expose:g,emit:y}){var J;ye(d=>({"419b3ca7":ie.value,"555fcd50":ne.value,"0deb9ba2":te.value,"015e26b6":Y.value,f947ba12:ee.value,"64e59945":c.value})),$e();const f=t(),D=Le(),S=fe("Message").value,_=t(null),k=t(),I=t(),h=t(),l=j(()=>D.params.boardId),b=a,B=t(null),E=t(null),s=t(""),V=t(""),z=t([]),O=t([]),F=t({}),W=t([]),Z=t([]),A=t([]),X=t(!1),oe=y,p=t("");let n;ae(p,()=>{clearTimeout(n),I.value.hide(),n=setTimeout(()=>{p.value&&(W.value=b.members.filter(d=>d.name.toLowerCase().includes(p.value.toLowerCase())||d.email.toLowerCase().includes(p.value.toLowerCase())).reduce((d,m)=>(A.value.find($=>$._id===m._id)||d.push({leftComponent:"Image",rounded:!0,src:m.profilePictureUrl,size:2,alt:"User Avatar",label:m.name,action:()=>{A.value.push(m),I.value.hide(),p.value="",W.value=[]}}),d),[]),setTimeout(()=>{var d;W.value.length&&(r(),(d=I.value)==null||d.show(f.value.$el.querySelector("#searchInput"),"left"))},0))},500)});const c=t(0),N=j(()=>{var d;return(d=k.value)==null?void 0:d.fullScreen}),ee=j(()=>{var d;return(d=k.value)!=null&&d.fullScreen?"contain":"cover"}),ie=j(()=>{var d;return(d=k.value)!=null&&d.fullScreen?"7px 77px":"0"}),ne=t(window.innerWidth<window.innerHeight?"grid":"auto"),te=t((J=k.value)!=null&&J.fullScreen&&window.innerWidth>window.innerHeight?"100%":"unset"),Y=t(`calc(50% - ${te.value} / 2)`);ae(N,()=>{r()});function he(d,m){if(B.value=d,m){const{_id:$,title:de,description:Ae,todos:Ke}=JSON.parse(JSON.stringify(m));E.value=$,s.value=de,V.value=Ae||"",z.value=Ke.map(Te=>({...Te,canEdit:!0}));let He=m.images.map((Te,Xe)=>({...Te,src:m.imageUrls[Xe].src}));O.value=He,A.value=m.assignedTo?JSON.parse(JSON.stringify(m.assignedTo)):[],Z.value=m.comments?JSON.parse(JSON.stringify(m.comments)):[],X.value=!0}else X.value=!1;f.value.show(),window.addEventListener("resize",r),setTimeout(()=>{if(O.value.length){let $=O.value;O.value=[],setTimeout(()=>{O.value=$,r()},0)}},300)}function ce(){let d=f.value.$el.querySelector(".todosList .todo:last-child .todoInput input");(!z.value.length||d&&d.value.trim())&&z.value.push({todo:"",done:!1,editing:!0,canEdit:!0}),setTimeout(()=>{d=f.value.$el.querySelector(".todosList .todo:last-child .todoInput input"),d&&(d.editing=!0,setTimeout(()=>{d.focus()},0))},0)}function ve(d){z.value.splice(z.value.indexOf(d),1)}function i(d){O.value=[...O.value,...Array.from(d.target.files).reduce((m,$)=>{if($.type.startsWith("image"))return[...m,{src:URL.createObjectURL($),file:$}]},[])],d.target.value=""}function r(){const d=f.value.$el.querySelector("#searchInput");d&&(c.value=d.getBoundingClientRect().width+"px"),k.value&&(ne.value=window.innerWidth<window.innerHeight?"grid":"auto",te.value=k.value.fullScreen&&window.innerWidth>window.innerHeight?"calc(100% - 33px)":"unset",Y.value=`calc(50% - ${te.value} / 2)`)}function L(){A.value.splice(A.value.indexOf(h.value.user),1),h.value.close()}function o(){let d=new FormData;return d.append("board",l.value),d.append("list",B.value._id||B.value),d.append("title",s.value),d.append("description",V.value),d.append("todos",JSON.stringify(z.value.map(m=>({todo:m.todo,done:m.done})))),O.value.map(m=>{m._id?d.append("keepImages",JSON.stringify(m)):(d.append("images",m.file),d.append("legends",F.value[m.file.name]))}),d.append("comments",JSON.stringify(Z.value)),d.append("assignedTo",JSON.stringify(A.value)),d}function e(d){d.shiftKey||(X.value?R():P(),d.preventDefault())}function P(){if(!s.value)return S.show({error:"Por favor, insira um título para o Card"});let d=o();G.createCard(d).then(m=>{oe("cardCreated",m.data),C(!0)})}function R(){if(!s.value)return S.show({error:"Por favor, insira um título para o Card"});let d=o();d.append("cardId",E.value),G.updateCard(d).then(m=>{oe("cardEdited",m.data),C(!0)})}function C(d){(d||X.value)&&(s.value="",V.value="",z.value=[],O.value=[],F.value={},A.value=[],Z.value=[]),f.value.close(),window.removeEventListener("resize",r)}return g({show:he}),(d,m)=>(u(),x(Q,null,[v(We,{ref_key:"modal",ref:f,id:"cardModal",onClose:C},{header:M(()=>[w("b",null,re(X.value?"Editar":"Novo")+" Card",1)]),footer:M(()=>[v(U,{class:"secondary",onClick:m[9]||(m[9]=$=>C(!0))},{default:M(()=>[ue("Cancelar")]),_:1}),X.value?(u(),K(U,{key:0,onClick:R},{default:M(()=>[ue("Atualizar")]),_:1})):(u(),K(U,{key:1,onClick:P},{default:M(()=>[ue("Criar")]),_:1}))]),default:M(()=>[v(pe,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=$=>s.value=$),label:"Título",class:"input",onFocus:m[1]||(m[1]=$=>we(S).closeByField("title")),onKeydown:me(T(e,["stop"]),["enter"])},null,8,["modelValue","onKeydown"]),v(Ie,{modelValue:V.value,"onUpdate:modelValue":m[2]||(m[2]=$=>V.value=$),label:"Descrição",class:"input",style:{resize:"vertical"},onKeydown:me(T(e,["stop"]),["enter"])},null,8,["modelValue","onKeydown"]),w("fieldset",null,[z.value.length?(u(),x("legend",rt,"Todos")):q("",!0),w("ul",ut,[(u(!0),x(Q,null,se(z.value,$=>(u(),K(Re,{key:$,todo:$,onRemoveTodo:ve,onNewTodo:ce},null,8,["todo"]))),128))]),v(U,{onClick:ce,class:"flat addItemButton"},{default:M(()=>[v(H,{class:"check-square"}),ct]),_:1})]),w("fieldset",null,[O.value.length?(u(),x("legend",vt,"Imagens")):q("",!0),v(Ne,{class:"carousel",ref_key:"carousel",ref:k},{default:M(()=>[(u(!0),x(Q,null,se(O.value,$=>(u(),x("div",{key:$,class:"slideWrapper"},[w("div",{class:"slide",onMouseenter:de=>$.mouseIn=!0,onMouseleave:de=>$.mouseIn=!1},[w("img",{src:$.src,alt:"task image",class:"image"},null,8,mt),$.file?(u(),K(pe,{key:0,placeholder:"Legenda",modelValue:F.value[$.file.name],"onUpdate:modelValue":de=>F.value[$.file.name]=de,class:"legendInput",onClick:m[3]||(m[3]=T(()=>{},["stop"])),onKeydown:m[4]||(m[4]=T(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"])):(u(),K(pe,{key:1,placeholder:"Legenda",modelValue:$.legend,"onUpdate:modelValue":de=>$.legend=de,class:"legendInput",onClick:m[5]||(m[5]=T(()=>{},["stop"])),onKeydown:m[6]||(m[6]=T(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"])),$.mouseIn?(u(),K(U,{key:2,class:"rmImgButton",onClick:T(de=>O.value.splice(O.value.indexOf($),1),["stop"])},{default:M(()=>[v(H,{class:"trash-2",size:1.15})]),_:2},1032,["onClick"])):q("",!0)],40,ft)]))),128))]),_:1},512),w("input",{type:"file",ref_key:"filePicker",ref:_,id:"filePicker",accept:"image/*",multiple:"",hidden:"",onChange:i},null,544),v(U,{onClick:m[7]||(m[7]=$=>_.value.click()),class:"flat addItemButton"},{default:M(()=>[v(H,{class:"image"}),pt]),_:1})]),v(pe,{id:"searchInput",type:"search",class:"input",label:"Atribuído a",placeholder:"Nome ou email",modelValue:p.value,"onUpdate:modelValue":m[8]||(m[8]=$=>p.value=$),autocomplete:"off"},null,8,["modelValue"]),v(Be,{list:W.value,ref_key:"dropDown",ref:I,class:"searchResultList"},null,8,["list"]),w("div",gt,[(u(!0),x(Q,null,se(A.value,$=>(u(),K(Oe,{key:$._id,user:$,class:"userBadge",onClick:de=>h.value.show($)},null,8,["user","onClick"]))),128))])]),_:1},512),v(Pe,{ref_key:"profileModal",ref:h},{default:M(()=>[v(U,{class:"danger",onClick:L},{default:M(()=>[ue("Remover")]),_:1})]),_:1},512)],64))}},wt=le(ht,[["__scopeId","data-v-1c5db466"]]),yt={class:"tabs"},bt={key:1},Ct={__name:"Tabs",setup(a,{expose:g}){const y=t(),f=t(),D=t(),S=t(!1),_=t([]),k=t(null);ae(k,(b,B)=>{let E=f.value.querySelector(`[tab-id=${B}]`);E&&(E.classList.remove("active"),E.style.display="none");let s=f.value.querySelector(`[tab-id=${b}]`);s.classList.add("active"),s.style.display="block"}),be(()=>{I(),h()});function I(){let b={childList:!0};D.value=new MutationObserver(()=>{h()}),D.value.observe(f.value,b)}function h(){let b=Array.from(f.value.querySelectorAll("[tab-id]"));if(!b.length)return console.error("No tabs found. Each tab must have a [tab-id] attribute.");_.value=b.map(B=>(B.style.display="none",{id:B.getAttribute("tab-id"),icon:B.getAttribute("tab-icon"),title:B.getAttribute("tab-title")})),k.value=_.value[0].id}function l(b){k.value==b?S.value=!S.value:(k.value=b,S.value=!0)}return g({showingContent:S}),(b,B)=>(u(),x("div",yt,[w("header",{ref_key:"header",ref:y},[w("nav",null,[(u(!0),x(Q,null,se(_.value,E=>(u(),K(U,{key:E.id,class:ge(`${k.value==E.id&&S.value?"active":"flat"} selector`),onClick:T(s=>l(E.id),["stop"]),onMousedown:B[0]||(B[0]=T(()=>{},["stop"]))},{default:M(()=>[E.icon?(u(),K(H,{key:0,class:ge(E.icon),size:.95},null,8,["class"])):q("",!0),E.title?(u(),x("span",bt,re(E.title),1)):q("",!0)]),_:2},1032,["class","onClick"]))),128))])],512),v(Ee,{name:"growDown"},{default:M(()=>[Ce(w("section",{ref_key:"section",ref:f},[Se(b.$slots,"default",{},void 0,!0)],512),[[ke,S.value]])]),_:3})]))}},kt=le(Ct,[["__scopeId","data-v-668c376c"]]),_t=["id","onMousedown","onMouseenter","onTouchmove"],$t={key:0},Tt={key:1},St={class:"assignedToListWrapper"},It={key:0,"tab-icon":"check-square","tab-id":"todosTab"},Lt={class:"todosList"},xt={key:1,"tab-icon":"image","tab-id":"imagesTab",class:"carouselTab"},Mt=["onMouseenter","onMouseleave"],Dt=["src"],Et={class:"legend"},Bt={"tab-icon":"message-square","tab-id":"commentsTab",class:"commentsTab"},Vt={class:"commentsList"},zt=["onMouseenter","onMouseleave"],Ot={key:0,class:"commentEditor"},Pt={key:1},Wt={key:2,class:"commentActions"},Nt={class:"newComment"},Rt={__name:"Card",props:{lists:Object,card:Object},emits:["showCardDropdown"],setup(a,{emit:g}){var L;ye(o=>({cd488c40:oe.value,"2d109691":p.value,"7bd06796":n.value,f7b747c6:c.value,b9f42da0:X.value}));const y=$e(),f=j(()=>y.state.board.draggingCard),D=t(),S=t(),_=t(),k=fe("Dialog").value,I=fe("Message").value,h=fe("profileModal").value,l=a,b=g,B=j(()=>{var o,e;return((o=y.state.board.draggingCard)==null?void 0:o._id)==((e=l.card)==null?void 0:e._id)}),E=j(()=>y.state.board.draggingShadow),s=t(null),V=t(null),z=t(null);let O,F,W=!1;ae(B,()=>{if(B.value){window.addEventListener("mouseup",r);let o=f.value.e;O=(o.clientX||o.touches[0].clientX)-D.value.getBoundingClientRect().left,F=(o.clientY||o.touches[0].clientY)-D.value.getBoundingClientRect().top;let e=D.value.cloneNode(!0);e.style=D.value.style,e.style.height=D.value.offsetHeight+"px",e.style.width=D.value.offsetWidth+"px",e.style.position="absolute",e.style.pointerEvents="none",e.style.zIndex="100",document.body.appendChild(e),y.dispatch("board/setDraggingShadow",e),document.body.style.userSelect="none",document.body.style.cursor="grabbing",window.addEventListener("mousemove",i),window.addEventListener("touchmove",i)}else E.value&&(window.removeEventListener("mouseup",r),E.value.remove(),y.dispatch("board/setDraggingShadow",null)),document.body.style.userSelect="auto",document.body.style.cursor="default",window.removeEventListener("mousemove",i),window.removeEventListener("touchmove",i)});let Z;ae(()=>l.card.mouseIn,()=>{clearTimeout(Z),Z=setTimeout(()=>{l.card.mouseIn=!1},3e3)});const A=j(()=>{var o;return(o=_.value)==null?void 0:o.fullScreen}),X=j(()=>{var o;return(o=_.value)!=null&&o.fullScreen?"contain":"cover"}),oe=j(()=>{var o;return(o=_.value)!=null&&o.fullScreen?"7px 77px":"0"}),p=t(window.innerWidth<window.innerHeight?"grid":"auto"),n=t((L=_.value)!=null&&L.fullScreen&&window.innerWidth>window.innerHeight?"calc(100% - 33px)":"unset"),c=t(`calc(50% - ${n.value} / 2)`);ae(A,()=>{ee()}),be(()=>{window.addEventListener("resize",ee)});function N(o,e){b("showCardDropdown",o,e.list,e)}function ee(){_.value&&(p.value=window.innerWidth<window.innerHeight?"grid":"auto",n.value=_.value.fullScreen&&window.innerWidth>window.innerHeight?"calc(100% - 33px)":"unset",c.value=`calc(50% - ${n.value} / 2)`)}function ie(){G.updateCard({cardId:l.card._id,todos:l.card.todos}).then(o=>{l.card.todos=o.data.todos})}async function ne(o){await k.confirm("Tem certeza que deseja remover esta tarefa?")&&(l.card.todos.splice(l.card.todos.indexOf(o),1),ie())}function te(o){l.card.newComment&&(l.card.comments||(l.card.comments=[]),l.card.comments.push({user:y.state.userProfile._id,text:l.card.newComment}),G.updateCard({cardId:l.card._id,comments:l.card.comments}).then(e=>{l.card.newComment="",l.card.comments=e.data.comments}))}function Y(o){if(!o.text)return I.show({error:"O comentário não pode estar vazio"});G.updateCard({cardId:l.card._id,comments:l.card.comments}).then(e=>{o.editing=!1,l.card.comments=e.data.comments})}async function he(o){await k.confirm("Deseja mesmo excluir este comentário?")&&(l.card.comments.splice(l.card.comments.indexOf(o),1),G.updateCard({cardId:l.card._id,comments:l.card.comments}).then(e=>{l.card.comments=e.data.comments}))}function ce(o){clearTimeout(z.value),W=!0,z.value=setTimeout(()=>{W&&(s.value=l.lists.find(e=>e.cards.find(P=>P._id==l.card._id)),V.value=s.value.cards.findIndex(e=>e._id==l.card._id),y.dispatch("board/setDraggingCard",{...l.card,e:o}))},150)}function ve(){f.value&&f.value._id!=l.card._id&&Me("changeCardsPositions",l.card._id)}function i(o){if(E.value)try{E.value.style.left=`${(o.clientX||o.touches[o.touches.length-1].clientX)-O}px`,E.value.style.top=`${(o.clientY||o.touches[o.touches.length-1].clientY)-F}px`}catch{}}function r(){let o=l.lists.find(e=>e.cards.find(P=>P._id==l.card._id));s.value._id!=o._id||V.value!=o.cards.findIndex(e=>e._id==l.card._id)?(l.card.list=o._id,Me("moveCard")):y.dispatch("board/setDraggingCard",null)}return xe(()=>{window.removeEventListener("resize",ee)}),(o,e)=>(u(),x("div",{id:a.card._id,class:ge(`card ${B.value?"dragging":""}`),ref_key:"cardEl",ref:D,onMousemove:e[11]||(e[11]=P=>a.card.mouseIn=!0),onMousedown:T(ce,["stop","prevent"]),onTouchstart:e[12]||(e[12]=T(P=>{a.card.mouseIn=!0,ce(P)},["stop","prevent"])),onMouseleave:e[13]||(e[13]=P=>a.card.mouseIn=!1),onMouseenter:T(ve,["stop","prevent"]),onTouchmove:T(ve,["stop","prevent"]),onMouseup:e[14]||(e[14]=P=>_e(W)?W.value=!1:W=!1),onTouchend:e[15]||(e[15]=P=>_e(W)?W.value=!1:W=!1)},[w("header",null,[w("b",null,re(a.card.title),1),!f.value&&a.card.mouseIn?(u(),K(U,{key:0,class:"optionsBt",onMousedown:e[0]||(e[0]=T(()=>{},["stop"])),onTouchstart:e[1]||(e[1]=T(()=>{},["stop"])),onClick:e[2]||(e[2]=T(P=>N(P.target,a.card),["stop"]))},{default:M(()=>[v(H,{class:"more-vertical",size:1.2})]),_:1})):q("",!0)]),a.card.description?(u(),x("hr",$t)):q("",!0),a.card.description||a.card.assignedTo?(u(),x("section",Tt,[ue(re(a.card.description)+" ",1),w("div",St,[(u(!0),x(Q,null,se(a.card.assignedTo,P=>(u(),x("div",{key:`${a.card._id}-${P._id}`},[P.profilePictureUrl?(u(),K(Je,{key:0,class:"user",src:P.profilePictureUrl,alt:"user avatar",rounded:"",size:1.5,onClick:T(R=>we(h).show(P),["stop","prevent"]),onMousedown:e[3]||(e[3]=T(()=>{},["stop"])),onTouchstart:e[4]||(e[4]=T(()=>{},["stop"]))},null,8,["src","onClick"])):(u(),K(H,{key:1,class:"user",size:1.5,rounded:"",onClick:T(R=>we(h).show(P),["stop","prevent"]),onMousedown:e[5]||(e[5]=T(()=>{},["stop"])),onTouchstart:e[6]||(e[6]=T(()=>{},["stop"]))},null,8,["onClick"]))]))),128))])])):q("",!0),w("footer",null,[v(kt,{ref_key:"cardTabs",ref:S,onClick:e[8]||(e[8]=T(()=>{},["stop"])),onMousedown:e[9]||(e[9]=T(()=>{},["stop"])),onTouchstart:e[10]||(e[10]=T(()=>{},["stop"]))},{default:M(()=>{var P,R;return[(P=a.card.todos)!=null&&P.length?(u(),x("div",It,[w("ul",Lt,[(u(!0),x(Q,null,se(a.card.todos,C=>(u(),K(Re,{key:C,todo:C,onRemoveTodo:J=>ne(C),onEditTodo:ie},null,8,["todo","onRemoveTodo"]))),128))])])):q("",!0),(R=a.card.images)!=null&&R.length?(u(),x("div",xt,[v(Ne,{class:"carousel",ref_key:"carousel",ref:_},{default:M(()=>[(u(!0),x(Q,null,se(a.card.imageUrls,C=>(u(),x("div",{key:C,class:"slideWrapper"},[w("div",{class:"slide",onMouseenter:J=>C.mouseIn=!0,onMouseleave:J=>C.mouseIn=!1},[w("img",{src:C.src,alt:"task image",class:"image"},null,8,Dt),w("span",Et,re(C.legend),1)],40,Mt)]))),128))]),_:1},512)])):q("",!0),w("div",Bt,[w("ul",Vt,[(u(!0),x(Q,null,se(a.card.comments,C=>(u(),x("li",{key:C,onMouseenter:J=>C.mouseIn=!0,onMouseleave:J=>C.mouseIn=!1},[v(Oe,{user:C.user,style:{"font-weight":"bold"}},null,8,["user"]),C.editing?(u(),x("div",Ot,[v(Ie,{placeholder:"Editar comentario",modelValue:C.text,"onUpdate:modelValue":J=>C.text=J,class:"commentInput",onKeypress:me(T(J=>Y(C),["stop"]),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeypress"]),w("div",null,[v(U,{type:"submit",class:"commentButton",onClick:J=>Y(C)},{default:M(()=>[v(H,{class:"edit",size:1})]),_:2},1032,["onClick"]),v(U,{class:"secondary commentButton",onClick:J=>C.editing=!1},{default:M(()=>[v(H,{class:"x",size:1})]),_:2},1032,["onClick"])])])):(u(),x("p",Pt,re(C.text),1)),C.mouseIn&&C.user._id===we(y).state.userProfile._id&&!C.editing?(u(),x("div",Wt,[v(U,{class:"flat actionBt",onClick:J=>he(C)},{default:M(()=>[v(H,{class:"trash-2",size:1.15})]),_:2},1032,["onClick"]),v(U,{class:"flat actionBt",onClick:J=>C.editing=!0},{default:M(()=>[v(H,{class:"edit",size:1.15})]),_:2},1032,["onClick"])])):q("",!0)],40,zt))),128))]),w("div",Nt,[v(Ie,{placeholder:"Comentar",modelValue:a.card.newComment,"onUpdate:modelValue":e[7]||(e[7]=C=>a.card.newComment=C),class:"commentInput",onKeypress:me(T(te,["stop"]),["enter"])},null,8,["modelValue","onKeypress"]),v(U,{type:"submit",class:"flat commentButton",onClick:te},{default:M(()=>[v(H,{class:"send",size:1})]),_:1})])])]}),_:1},512)])],42,_t))}},Ut=le(Rt,[["__scopeId","data-v-61a9a505"]]),At=a=>(Ve("data-v-0c31959d"),a=a(),ze(),a),Kt=["id","onMousedown","onTouchstart"],Ht=At(()=>w("span",null,"Novo Card",-1)),Xt={__name:"List",props:{lists:Object,list:Object},emits:["showListDropdown","showCardDropdown","showCardModal","changeListsPositions","updateListsPositions","moveCardToList"],setup(a,{emit:g}){ye(n=>({40982693:z.value}));const y=$e(),f=j(()=>y.state.board.draggingList),D=j(()=>y.state.board.draggingCard),S=t(),_=a,k=g,I=t(!1),h=t(null),l=t(null),b=t(null);let B,E,s=!1;ae(I,()=>{var n;if(y.dispatch("board/setDraggingList",(n=I.value)==null?void 0:n._id),I.value){window.addEventListener("mouseup",X),window.addEventListener("touchend",X);let c=I.value.e,N=S.value.getBoundingClientRect();B=(c.clientX||c.touches[0].clientX)-N.left,E=(c.clientY||c.touches[0].clientY)-N.top,h.value=S.value.cloneNode(!0),h.value.style=S.value.style,h.value.style.height=S.value.offsetHeight+"px",h.value.style.position="absolute",h.value.style.pointerEvents="none",h.value.style.zIndex="100",document.body.appendChild(h.value),document.body.style.userSelect="none",document.body.style.cursor="grabbing"}else window.removeEventListener("mouseup",X),window.removeEventListener("touchend",X),h.value&&h.value.remove(),document.body.style.userSelect="auto",document.body.style.cursor="default"});const V=t(),z=t(V.value?V.value.offsetHeight+123+"px":0),O=t();be(()=>{F(),z.value=V.value?V.value.offsetHeight+123+"px":0,window.addEventListener("mousemove",p),window.addEventListener("touchmove",p)});function F(){let n={childList:!0,subtree:!0,attributes:!0};O.value=new MutationObserver(()=>{z.value=V.value?V.value.offsetHeight+123+"px":0}),O.value.observe(S.value,n)}function W(n,c){k("showListDropdown",n,c)}function Z(n,c,N){k("showCardDropdown",n,c,N)}function A(n){clearTimeout(b.value),s=!0,b.value=setTimeout(()=>{s&&(n.button==0||n.touches)&&(l.value=_.lists.findIndex(c=>c._id===_.list._id),I.value={_id:_.list._id,e:n})},150)}function X(){l.value!=_.lists.findIndex(n=>n._id===_.list._id)&&k("updateListsPositions"),setTimeout(()=>{I.value=!1},0)}function oe(){f.value&&f.value!=_.list._id&&k("changeListsPositions",_.list._id),D.value&&!_.list.cards.find(n=>n._id==D.value._id)&&k("moveCardToList",{from:_.lists.find(n=>n.cards.find(c=>c._id==D.value._id))._id,to:_.list._id})}function p(n){var c;if(f.value||D.value)if(f.value==S.value.id)try{h.value.style.left=`${(n.clientX||n.touches[n.touches.length-1].clientX)-B}px`,h.value.style.top=`${(n.clientY||n.touches[n.touches.length-1].clientY)-E}px`}catch{}else((c=n.touches)!=null&&c.length?document.elementsFromPoint(n.touches[n.touches.length-1].clientX,n.touches[n.touches.length-1].clientY):document.elementsFromPoint(n.clientX,n.clientY)).find(ee=>ee.id==S.value.id)&&oe()}return xe(()=>{var n;(n=O.value)==null||n.disconnect(),window.removeEventListener("mousemove",p),window.removeEventListener("touchmove",p)}),(n,c)=>(u(),x("div",{id:a.list._id,class:ge(`list ${I.value?"dragging":""}`),ref_key:"listEl",ref:S,onMousedown:T(A,["stop","prevent"]),onTouchstart:T(A,["stop","prevent"]),onMouseup:c[6]||(c[6]=N=>_e(s)?s.value=!1:s=!1),onTouchend:c[7]||(c[7]=N=>_e(s)?s.value=!1:s=!1)},[w("header",null,[w("b",null,re(a.list.name),1),v(U,{class:"optionsBt",onMousedown:c[0]||(c[0]=T(()=>{},["stop"])),onTouchstart:c[1]||(c[1]=T(()=>{},["stop"])),onClick:c[2]||(c[2]=T(N=>W(N.target,a.list),["stop"]))},{default:M(()=>[v(H,{class:"more-vertical",size:1.5})]),_:1})]),w("section",null,[w("div",{class:"cardsWrapper",ref_key:"cardsWrapper",ref:V},[(u(!0),x(Q,null,se(a.list.cards,N=>(u(),K(Ut,{key:N._id,lists:a.lists,card:N,onShowCardDropdown:Z},null,8,["lists","card"]))),128))],512)]),w("footer",null,[v(U,{class:"addCardBt",onMousedown:c[3]||(c[3]=T(()=>{},["stop"])),onTouchstart:c[4]||(c[4]=T(()=>{},["stop"])),onClick:c[5]||(c[5]=T(N=>n.$emit("showCardModal"),["stop"]))},{default:M(()=>[v(H,{class:"plus",size:1.7}),Ht]),_:1})])],42,Kt))}},Ft=le(Xt,[["__scopeId","data-v-0c31959d"]]),Jt={__name:"Board",setup(a){const g=$e(),y=Le(),f=t(y.params.boardId),D=t();qe("profileModal",D);const S=t(),_=t(),k=t(),I=fe("Message").value,h=fe("Dialog").value,l=t(),b=t(""),B=t({}),E=t([]),s=t([]),V=t([]),z=j(()=>g.state.board.dragScrolling);ae(()=>y.params.boardId,()=>{f.value=y.params.boardId,b.value="",B.value={},E.value=[],s.value=[],O()}),be(()=>{O(),document.addEventListener("moveCard",ve),document.addEventListener("changeCardsPositions",ce)});function O(){G.getBoardDetails(f.value).then(i=>{b.value=i.data.board.name,g.dispatch("setTitle",i.data.board.name),B.value=i.data.board.owner,E.value=i.data.board.sharedWith,s.value=i.data.lists})}function F(i,r,L){if(S.value.showing)return S.value.hide(),i!==S.value.target?setTimeout(()=>{F(i,r,L)},200):void 0;V.value=[{leftComponent:"Icon",class:"edit",size:1.15,label:L?"Editar":"Renomear",action:()=>L?ne(r,L):_.value.show(r)},{leftComponent:"Icon",class:"trash",size:1.15,label:"Excluir",action:async()=>{await h.confirm(`Deseja mesmo excluir ${L?"o card":"a lista"} <b style='font-size: 1.2em;'>${L?L.title:r.name}</b>?`)&&(L?G.deleteCard(L._id).then(()=>{n(L)}):G.deleteList(r._id).then(()=>{A(r)}))}}],setTimeout(()=>{S.value.toggleShowing(i,"right")},0)}function W(i){s.value.push(i)}function Z(i){s.value.splice(s.value.findIndex(r=>r._id===i._id),1,i),setTimeout(()=>{I.show({success:"Lista renomeada com sucesso!"})},0)}function A(i){s.value.splice(s.value.findIndex(r=>r._id===i._id),1),setTimeout(()=>{I.show({success:"Lista excluida com sucesso!"})},0)}function X(i){let r=g.state.board.draggingList,L=s.value.findIndex(e=>e._id===r),o=s.value.findIndex(e=>e._id===i);r=s.value.find(e=>e._id==r),L<o?(s.value.splice(o+1,0,r),s.value.splice(L,1)):(s.value.splice(L,1),s.value.splice(o,0,r))}function oe(){G.updateBoard({boardId:f.value,listsOrder:s.value.reduce((i,r)=>(i.push(r._id),i),[])})}function p(i){s.value.find(r=>r._id===i.list).cards.push(i)}function n(i){s.value.find(r=>r._id===i.list).cards.splice(s.value.find(r=>r._id===i.list).cards.findIndex(r=>r._id===i._id),1)}function c(i){s.value.find(r=>r._id===i.list).cards.splice(s.value.find(r=>r._id===i.list).cards.findIndex(r=>r._id===i._id),1,i)}function N(i){!g.state.board.draggingList&&i.clientX&&g.dispatch("board/setDragScrolling",{startX:i.clientX})}function ee(i){if(z.value&&!g.state.board.draggingList){g.dispatch("board/setDragScrolling",{...g.state.board.dragScrolling,x:i.clientX});let r=g.state.board.dragScrolling.x-g.state.board.dragScrolling.startX;r<0&&(r*=-1),r>10&&(l.value.scrollLeft-=g.state.board.dragScrolling.x-g.state.board.dragScrolling.startX,g.dispatch("board/setDragScrolling",{...g.state.board.dragScrolling,startX:g.state.board.dragScrolling.x}))}}function ie(){g.dispatch("board/setDragScrolling",null)}function ne(i,r){k.value.show(i,r)}let te,Y;function he({from:i,to:r}){let L=s.value.find(o=>o._id==i).cards.find(o=>o._id==g.state.board.draggingCard._id);te=s.value.find(o=>o._id==i),te.cards.splice(te.cards.findIndex(o=>o._id==L._id),1),Y=s.value.find(o=>o._id==r),Y.cards||(Y.cards=[]),Y.cards.unshift(L)}function ce(i){let r=i.detail,L=g.state.board.draggingCard,o=s.value.find(R=>R.cards.find(C=>C._id==r));if(!o.cards.find(R=>R._id==L._id))return;te=o,Y=o;let e=o.cards.findIndex(R=>R._id===L._id),P=o.cards.findIndex(R=>R._id===r);e<P?(o.cards.splice(P+1,0,L),o.cards.splice(e,1)):(o.cards.splice(e,1),o.cards.splice(P,0,L)),setTimeout(()=>{s.value.filter(R=>R._id!=o._id&&R.cards.find(C=>C._id==L._id)).map(R=>{R.cards.splice(R.cards.findIndex(C=>C._id==L._id),1)})},0)}function ve(){let i=g.state.board.draggingCard;i&&(G.moveCard({board:f.value,fromList:i.list,toList:Y._id,card:i._id,index:Y.cards.findIndex(r=>r._id===i._id)}),g.dispatch("board/setDraggingCard",null))}return xe(()=>{g.dispatch("setTitle","TaskBoard"),document.removeEventListener("moveCard",ve),document.removeEventListener("changeCardsPositions",ce)}),(i,r)=>(u(),x(Q,null,[w("section",{ref_key:"section",ref:l,onMousedown:N,onMousemove:ee,onMouseup:ie,onMouseleave:ie},[(u(!0),x(Q,null,se(s.value,L=>(u(),K(Ft,{class:"boardList",id:L._id,key:L._id,lists:s.value,list:L,onShowListDropdown:F,onChangeListsPositions:X,onUpdateListsPositions:oe,onShowCardModal:o=>ne(L,null),onShowCardDropdown:F,onMoveCardToList:he},null,8,["id","lists","list","onShowCardModal"]))),128))],544),v(je,{id:"newListBt",onClick:r[0]||(r[0]=L=>_.value.show())},{default:M(()=>[ue("Nova Lista")]),_:1}),v(Be,{ref_key:"dropDown",ref:S,list:V.value},null,8,["list"]),v(Ge,{ref_key:"listModal",ref:_,onListCreated:W,onListRenamed:Z},null,512),v(wt,{ref_key:"cardModal",ref:k,members:[B.value,...E.value],onCardCreated:p,onCardEdited:c},null,8,["members"]),v(Pe,{ref_key:"profileModal",ref:D},null,512)],64))}},Gt=le(Jt,[["__scopeId","data-v-a2f9972d"]]);export{Gt as default};
